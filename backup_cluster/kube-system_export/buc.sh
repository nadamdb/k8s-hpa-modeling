#!/bin/bash
for n in $(kubectl -n kube-system get -o=name alertmanagers.monitoring.coreos.com,ingresses.extensions,priorityclasses.scheduling.k8s.io,apiservices.apiregistration.k8s.io,jobs.batch,prometheuses.monitoring.coreos.com,certificatesigningrequests.certificates.k8s.io,leases.coordination.k8s.io,prometheusrules.monitoring.coreos.com,clusterrolebindings.rbac.authorization.k8s.io,limitranges,replicasets.apps,clusterroles.rbac.authorization.k8s.io,mutatingwebhookconfigurations.admissionregistration.k8s.io,replicasets.extensions,componentstatuses,namespaces,replicationcontrollers,configmaps,networkpolicies.extensions,resourcequotas,controllerrevisions.apps,networkpolicies.networking.k8s.io,rolebindings.rbac.authorization.k8s.io,cronjobs.batch,nodes,roles.rbac.authorization.k8s.io,customresourcedefinitions.apiextensions.k8s.io,secrets,daemonsets.apps,persistentvolumeclaims,serviceaccounts,daemonsets.extensions,persistentvolumes,servicemonitors.monitoring.coreos.com,deployments.apps,poddisruptionbudgets.policy,services,deployments.extensions,pods,statefulsets.apps,endpoints,storageclasses.storage.k8s.io,events,podsecuritypolicies.extensions,validatingwebhookconfigurations.admissionregistration.k8s.io,events.events.k8s.io,podsecuritypolicies.policy,volumeattachments.storage.k8s.io,horizontalpodautoscalers.autoscaling,podtemplates | grep -v 'secret/default-token')
do
	kubectl -n kube-system get -o=yaml --export $n > $(dirname $n)_$(basename $n).yaml
done
